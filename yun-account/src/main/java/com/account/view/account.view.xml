<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Arguments/>
  <Context/>
  <Model>
    <DataType name="Account">
      <Property name="creationType">com.account.pojo.Account</Property>
      <Property name="defaultDisplayProperty">name</Property>
      <Reference name="child">
        <Property name="dataProvider">accountService#getAccountsByParentId</Property>
        <Property name="dataType">[SELF]</Property>
        <Property name="parameter">$${this.id}</Property>
      </Reference>
      <Reference name="records">
        <Property name="dataProvider">recordService#getRecordsByAccountId</Property>
        <Property name="dataType">[Record]</Property>
        <Property name="pageSize">20</Property>
        <Property name="parameter">$${this.id}</Property>
      </Reference>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
        <Property name="required">true</Property>
        <Property name="label">分类名称</Property>
      </PropertyDef>
      <PropertyDef name="id">
        <Property name="dataType">Long</Property>
        <Property name="label">ID</Property>
      </PropertyDef>
      <PropertyDef name="parentAccountId">
        <Property name="dataType">Long</Property>
      </PropertyDef>
      <PropertyDef name="isDeleted">
        <Property name="dataType">Boolean</Property>
      </PropertyDef>
      <PropertyDef name="delTime">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="crTime">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="crUser">
        <Property></Property>
      </PropertyDef>
      <PropertyDef name="delUser">
        <Property></Property>
      </PropertyDef>
      <PropertyDef name="sortFlag">
        <Property name="dataType">Integer</Property>
      </PropertyDef>
      <PropertyDef name="remark">
        <Property></Property>
        <Property name="label">备注</Property>
      </PropertyDef>
    </DataType>
    <DataType name="Record">
      <Property name="creationType">com.account.pojo.Record</Property>
      <PropertyDef name="type">
        <Property name="dataType">Integer</Property>
        <Property name="label">类型</Property>
        <Property name="required">true</Property>
        <Property name="mapping">
          <Property name="mapValues">
            <Collection>
              <Entity>
                <Property name="key">1</Property>
                <Property name="value">支出</Property>
              </Entity>
              <Entity>
                <Property name="key">2</Property>
                <Property name="value">收入</Property>
              </Entity>
            </Collection>
          </Property>
        </Property>
      </PropertyDef>
      <PropertyDef name="name">
        <Property name="dataType">String</Property>
        <Property name="label">名称</Property>
        <Property name="required">true</Property>
      </PropertyDef>
      <PropertyDef name="id">
        <Property name="dataType">Long</Property>
        <Property name="label">ID</Property>
      </PropertyDef>
      <PropertyDef name="doDate">
        <Property name="dataType">Date</Property>
        <Property name="displayFormat">Y-m-d</Property>
        <Property name="label">日期</Property>
        <Property name="required">true</Property>
      </PropertyDef>
      <PropertyDef name="money">
        <Property name="dataType">Double</Property>
        <Property name="label">金额</Property>
        <Property name="required">true</Property>
      </PropertyDef>
      <PropertyDef name="accountId">
        <Property name="dataType">Long</Property>
      </PropertyDef>
      <PropertyDef name="accountName">
        <Property name="dataType">String</Property>
        <Property name="label">账户</Property>
      </PropertyDef>
      <PropertyDef name="remark">
        <Property name="dataType">String</Property>
        <Property name="label">备注</Property>
      </PropertyDef>
      <PropertyDef name="tag">
        <Property name="dataType">String</Property>
        <Property name="label">标签</Property>
      </PropertyDef>
      <PropertyDef name="isDeleted">
        <Property name="dataType">Boolean</Property>
      </PropertyDef>
      <PropertyDef name="delTime">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="crTime">
        <Property name="dataType">Date</Property>
      </PropertyDef>
      <PropertyDef name="crUser">
        <Property></Property>
      </PropertyDef>
      <PropertyDef name="delUser">
        <Property></Property>
      </PropertyDef>
    </DataType>
  </Model>
  <View layout="padding:20">
    <Action id="actionAdd">
      <Property name="caption">添加新分类</Property>
      <Property name="icon">url(>skin>common/icons.gif) -280px -100px</Property>
      <Property name="tip">点击树的空白处，不选中任何分类，就可以添加顶层分类了。</Property>
    </Action>
    <Action id="actionMove">
      <Property name="tags">onCurrentNode</Property>
      <Property name="disabled">true</Property>
      <Property name="caption">移动分类</Property>
      <Property name="icon">url(>skin>common/icons.gif) -180px -120px</Property>
    </Action>
    <Action id="actionRemove">
      <Property name="disabled">true</Property>
      <Property name="tags">onCurrentNode</Property>
      <Property name="caption">删除分类</Property>
      <Property name="icon">url(>skin>common/icons.gif) -300px -100px</Property>
      <Property name="confirmMessage">如果删除分类，该分类下的记录也会一并删除，是否确定删除？</Property>
    </Action>
    <Action id="actionCancel">
      <Property name="disabled">true</Property>
      <Property name="tags">onDirtyNode</Property>
      <Property name="caption">取消</Property>
      <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
    </Action>
    <UpdateAction id="actionSaveAll">
      <Property name="dataResolver">accountService#saveAccounts</Property>
      <Property name="executingMessage">系统正在保存</Property>
      <Property name="successMessage">数据保存成功</Property>
      <Property name="caption">保存所有</Property>
      <Property name="icon">url(>skin>common/icons.gif) -160px -20px</Property>
      <Property name="tags">onDirty</Property>
      <UpdateItem>
        <Property name="dataSet">dsAccounts</Property>
      </UpdateItem>
    </UpdateAction>
    <DataSet id="dsAccounts">
      <Property name="dataProvider">accountService#getAccountsByParentId</Property>
      <Property name="dataType">[Account]</Property>
      <Property name="readOnly">false</Property>
    </DataSet>
    <ToolBar>
      <ToolBarButton>
        <Property name="action">actionAdd</Property>
      </ToolBarButton>
      <Separator/>
      <ToolBarButton>
        <Property name="disabled">false</Property>
        <Property name="action">actionMove</Property>
      </ToolBarButton>
      <Separator/>
      <ToolBarButton>
        <Property name="disabled">false</Property>
        <Property name="action">actionRemove</Property>
      </ToolBarButton>
      <Separator/>
      <ToolBarButton>
        <Property name="disabled">false</Property>
        <Property name="action">actionCancel</Property>
      </ToolBarButton>
      <Separator/>
      <ToolBarButton>
        <Property name="disabled">false</Property>
        <Property name="action">actionSaveAll</Property>
      </ToolBarButton>
    </ToolBar>
    <SplitPanel>
      <Property name="position">200</Property>
      <MainControl>
        <CardBook id="cardbook">
          <Container>
            <DataGrid>
              <DataColumn>
                <Property name="caption">测试</Property>
                <Editor/>
              </DataColumn>
            </DataGrid>
          </Container>
          <Container>
            <AutoForm id="accountForm">
              <Property name="createPrivateDataSet">false</Property>
              <Property name="dataSet">dsAccounts</Property>
              <Property name="dataPath">!CURRENT_ACCOUNT</Property>
              <Property name="cols">*</Property>
              <AutoFormElement>
                <Property name="name">name</Property>
                <Property name="property">name</Property>
                <Editor/>
              </AutoFormElement>
              <AutoFormElement>
                <Property name="name">remark</Property>
                <Property name="property">remark</Property>
                <Editor/>
              </AutoFormElement>
            </AutoForm>
            <ToolBar>
              <DataPilot>
                <Property name="itemCodes">pages,pageSize,+,-,x</Property>
                <Property name="dataPath">!CURRENT_ACCOUNT.records</Property>
                <Property name="dataSet">dsAccounts</Property>
              </DataPilot>
              <Separator/>
              <ToolBarButton>
                <Property name="caption">导出</Property>
                <Property name="icon">url(>skin>common/icons.gif) -180px -120px</Property>
                <Property name="action">export2ReportAction1</Property>
              </ToolBarButton>
              <Separator/>
              <ToolBarButton id="printBtn">
                <Property name="caption">打印</Property>
                <Property name="icon">url(>skin>common/icons.gif) -120px -20px</Property>
              </ToolBarButton>
            </ToolBar>
            <DataGrid id="recordDataGrid">
              <Property name="dataPath">!CURRENT_ACCOUNT.records</Property>
              <Property name="dataSet">dsAccounts</Property>
              <Property name="allowNoCurrent">true</Property>
              <Property name="appendOnLastEnter">true</Property>
              <Property name="highlightCurrentRow">true</Property>
              <IndicatorColumn/>
              <DataColumn>
                <Property name="property">name</Property>
                <Editor/>
              </DataColumn>
              <DataColumn>
                <Property name="property">money</Property>
                <Editor/>
              </DataColumn>
              <DataColumn>
                <Property name="property">type</Property>
                <Property name="editable">false</Property>
                <Editor/>
              </DataColumn>
              <DataColumn>
                <Property name="property">doDate</Property>
                <Property name="editable">false</Property>
                <Editor/>
              </DataColumn>
              <DataColumn name="accountName">
                <Property name="property">accountName</Property>
              </DataColumn>
              <DataColumn name="tag">
                <Property name="property">tag</Property>
              </DataColumn>
              <DataColumn name="remark">
                <Property name="property">remark</Property>
              </DataColumn>
            </DataGrid>
            <Export2ReportAction id="export2ReportAction1">
              <Property name="executingMessage">正在导出...</Property>
              <Property name="fileName">record</Property>
              <Property name="showTitle">true</Property>
              <Property name="titleName">记录明细</Property>
              <Property name="maxSize">10000</Property>
              <Property name="confirmMessage">确定导出这些记录吗？</Property>
              <Property name="dataScope">serverAll</Property>
              <Property name="template">recordDataGrid</Property>
            </Export2ReportAction>
          </Container>
        </CardBook>
      </MainControl>
      <SideControl>
        <DataTree id="dataTreeAccount">
          <Property name="currentNodeDataPath">CURRENT_ACCOUNT</Property>
          <Property name="dataSet">dsAccounts</Property>
          <Property name="allowNoCurrent">true</Property>
          <BindingConfigs>
            <BindingConfig>
              <Property name="childrenProperty">child</Property>
              <Property name="expandLevel">2</Property>
              <Property name="labelProperty">name</Property>
              <Property name="recursive">true</Property>
              <Property name="hasChild">true</Property>
            </BindingConfig>
          </BindingConfigs>
        </DataTree>
      </SideControl>
    </SplitPanel>
    <Menu id="menuAccounts">
      <MenuItem>
        <Property name="action">actionAdd</Property>
      </MenuItem>
      <MenuItem>
        <Property name="action">actionMove</Property>
      </MenuItem>
      <Separator/>
      <MenuItem>
        <Property name="action">actionRemove</Property>
      </MenuItem>
    </Menu>
    <AjaxAction id="ajaxActionCheckAccountChildren">
      <Property name="service">accountService#checkAccount</Property>
    </AjaxAction>
  </View>
</ViewConfig>
