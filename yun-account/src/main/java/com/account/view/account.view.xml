<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
    <Arguments/>
    <Context/>
    <Model>
        <DataType name="Account">
            <Property name="autoCreatePropertyDefs">true</Property>
            <Property name="creationType">com.account.pojo.Account</Property>
            <Property name="defaultDisplayProperty">name</Property>
            <Reference name="child">
                <Property name="dataProvider">accountService#getAccountsByParentId</Property>
                <Property name="dataType">[SELF]</Property>
                <Property name="parameter">$${this.id}</Property>
            </Reference>
            <Reference name="records">
                <Property name="dataProvider">recordService#getRecordsByAccountId</Property>
                <Property name="dataType">[Record]</Property>
                <Property name="pageSize">20</Property>
                <Property name="parameter">$${this.id}</Property>
            </Reference>
        </DataType>
        <DataType name="Record">
            <Property name="autoCreatePropertyDefs">true</Property>
            <Property name="creationType">com.account.pojo.Record</Property>
            <PropertyDef name="type">
                <Property name="dataType">Integer</Property>
                <Property name="label">类型</Property>
                <Property name="mapping">
                    <Property name="mapValues">
                        <Collection>
                            <Entity>
                                <Property name="key">1</Property>
                                <Property name="value">支出</Property>
                            </Entity>
                            <Entity>
                                <Property name="key">2</Property>
                                <Property name="value">收入</Property>
                            </Entity>
                        </Collection>
                    </Property>
                </Property>
                <Property name="required">true</Property>
            </PropertyDef>
            <PropertyDef name="name">
                <Property name="dataType">String</Property>
                <Property name="label">名称</Property>
                <Property name="required">true</Property>
            </PropertyDef>
            <PropertyDef name="id">
                <Property name="dataType">Long</Property>
                <Property name="label">ID</Property>
            </PropertyDef>
            <PropertyDef name="doDate">
                <Property name="dataType">Date</Property>
                <Property name="displayFormat">Y-m-d</Property>
                <Property name="label">日期</Property>
                <Property name="required">true</Property>
            </PropertyDef>
            <PropertyDef name="money">
                <Property name="dataType">Double</Property>
                <Property name="label">金额</Property>
                <Property name="required">true</Property>
            </PropertyDef>
        </DataType>
    </Model>
    <View layout="padding:20;">
        <DataSet id="dsAccounts">
            <Property name="dataProvider">accountService#getAccountsByParentId</Property>
            <Property name="dataType">[Account]</Property>
            <Property name="readOnly">true</Property>
        </DataSet>
        <SplitPanel>
            <Property name="position">200</Property>
            <MainControl>
                <Panel layout="padding:1;">
                    <Property name="caption">明细</Property>
                    <Property name="icon">url(>skin>common/icons.gif) -180px -140px</Property>
                    <Buttons/>
                    <Children>
                        <ToolBar>
                            <DataPilot/>
                            <Separator/>
                            <ToolBarButton>
                                <Property name="caption">导出</Property>
                                <Property name="icon">url(>skin>common/icons.gif) -180px -120px</Property>
                            </ToolBarButton>
                            <Separator/>
                            <ToolBarButton>
                                <Property name="caption">打印</Property>
                                <Property name="icon">url(>skin>common/icons.gif) -120px -20px</Property>
                            </ToolBarButton>
                        </ToolBar>
                        <DataGrid>
                            <Property name="dataPath">!CURRENT_ACCOUNT.records</Property>
                            <Property name="dataSet">dsAccounts</Property>
                            <DataColumn>
                                <Property name="property">name</Property>
                                <Editor/>
                            </DataColumn>
                            <DataColumn>
                                <Property name="property">money</Property>
                                <Editor/>
                            </DataColumn>
                            <DataColumn>
                                <Property name="property">type</Property>
                                <Editor/>
                            </DataColumn>
                            <DataColumn>
                                <Property name="property">doDate</Property>
                                <Editor/>
                            </DataColumn>
                        </DataGrid>
                    </Children>
                    <Tools/>
                </Panel>
            </MainControl>
            <SideControl>
                <Panel layout="padding:1;">
                    <Property name="caption">分类</Property>
                    <Property name="icon">url(>skin>common/icons.gif) -260px -40px</Property>
                    <Buttons/>
                    <Children>
                        <DataTree>
                            <Property name="currentNodeDataPath">CURRENT_ACCOUNT</Property>
                            <Property name="dataSet">dsAccounts</Property>
                            <BindingConfigs>
                                <BindingConfig>
                                    <Property name="childrenProperty">child</Property>
                                    <Property name="expandLevel">2</Property>
                                    <Property name="labelProperty">name</Property>
                                    <Property name="recursive">true</Property>
                                </BindingConfig>
                            </BindingConfigs>
                        </DataTree>
                    </Children>
                    <Tools/>
                </Panel>
            </SideControl>
        </SplitPanel>
    </View>
</ViewConfig>
