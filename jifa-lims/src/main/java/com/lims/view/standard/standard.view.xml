<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
	<Arguments/>
	<Context/>
	<Model>
		<DataType name="dtStandards" parent="standardDataType">
		</DataType>
	</Model>
	<View>
		<Property name="packages">font-awesome</Property>
		<DataSet id="dsStandards">
			<Property name="dataProvider">standardService#queryStandards</Property>
			<Property name="dataType">[dtStandards]</Property>
			<Property name="pageSize">20</Property>
		</DataSet>
		<DataSet id="dsMethodStandards">
			<Property name="dataProvider">standardService#queryMethodStandards</Property>
			<Property name="dataType">[methodStandardDataType]</Property>
			<ClientEvent name="beforeLoadData" signature="self,arg">var dsStandards = view.id(&quot;dsStandards&quot;);
var dsMethodStandards=view.id(&quot;dsMethodStandards&quot;);
var currData = dsStandards.getData(&quot;#&quot;);
if(currData){
	dsMethodStandards.set(&quot;parameter&quot;,currData.id);
}</ClientEvent>
		</DataSet>
		<SplitPanel>
			<Property name="direction">top</Property>
			<Property name="position">200</Property>
			<MainControl>
				<Container>
					<TabControl>
						<Property name="currentTab">0</Property>
						<ControlTab id="msCtrl">
							<Property name="caption">方法标准管理</Property>
							<Property name="name">方法标准管理</Property>
							<Container>
								<ToolBar>
									<DataPilot>
										<Property name="dataPath">#.methodStandards</Property>
										<Property name="dataSet">dsStandards</Property>
										<Property name="itemCodes">pages,+,-,x</Property>
										<ClientEvent name="onSubControlAction" signature="self,arg">var datas = view.get(&quot;#dsMethodStandards.data&quot;);
var action = view.get(&quot;#msUpdateAction&quot;);
var dsStandards = view.id(&quot;dsStandards&quot;);
var currData = dsStandards.getData(&quot;#&quot;);
if(currData){
  var standardId=currData.id;
}
switch(arg.code){
	case &quot;+&quot;:{
		var entity=datas.insert();
    entity.set(&quot;standardId&quot;,standardId);
		view.get(&quot;#methodStandardDialog&quot;).show();
		arg.processDefault=false;
		break;
	}
	case &quot;-&quot;:{
		dorado.MessageBox.confirm(&quot;您真的想删除当前数据吗?&quot;,function(){
			datas.remove();
			action.execute();
		});
		arg.processDefault=false;
		break;
	}
}</ClientEvent>
									</DataPilot>
									<Separator/>
									<ToolBarButton id="editMsBtn">
										<Property name="caption">编辑</Property>
										<ClientEvent name="onClick" signature="self,arg">var dsMethodStandards = view.id(&quot;dsMethodStandards&quot;);
var currData = dsMethodStandards.getData(&quot;#&quot;);
if(currData){
 	view.id(&quot;standardUpdateAction&quot;).show();
}</ClientEvent>
									</ToolBarButton>
								</ToolBar>
								<DataGrid>
									<Property name="dataPath">#.methodStandards</Property>
									<Property name="dataSet">dsStandards</Property>
									<DataColumn>
										<Property name="caption">标准名称</Property>
										<Property name="property">name</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">标准号</Property>
										<Property name="property">standardNo</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">状态</Property>
										<Property name="property">status</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">基准价格</Property>
										<Property name="property">price</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">单位</Property>
										<Property name="property">unit</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">备注</Property>
										<Property name="property">remark</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">创建人</Property>
										<Property name="property">crUser</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">创建时间</Property>
										<Property name="property">crTime</Property>
										<Editor/>
									</DataColumn>
								</DataGrid>
								<Dialog id="methodStandardDialog">
									<Property name="caption">方法标准维护</Property>
									<Buttons>
										<Button id="saveMsBtn">
											<Property name="caption">保存</Property>
											<ClientEvent name="onClick" signature="self,arg">var msUpdateAction=view.id(&quot;msUpdateAction&quot;);
var methodStandardDialog=view.id(&quot;methodStandardDialog&quot;);
msUpdateAction.execute(function(){
  methodStandardDialog.hide();
});</ClientEvent>
										</Button>
										<Button id="cancelMsBtn">
											<Property name="caption">取消</Property>
											<ClientEvent name="onClick" signature="self,arg">var methodStandardDialog=view.id(&quot;methodStandardDialog&quot;);
methodStandardDialog.hide();</ClientEvent>
										</Button>
									</Buttons>
									<Children>
										<AutoForm>
											<Property name="cols">＊</Property>
											<Property name="dataSet">dsMethodStandards</Property>
											<AutoFormElement>
												<Property name="label">标准名词</Property>
												<Property name="property">name</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">标准号</Property>
												<Property name="property">standardNo</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">基准价格</Property>
												<Property name="property">price</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">备注</Property>
												<Property name="property">remark</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">单位</Property>
												<Property name="property">unit</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="editable">false</Property>
												<Property name="label">状态</Property>
												<Property name="property">status</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">所属产品标准</Property>
												<Property name="property">standardId</Property>
												<Property name="visible">false</Property>
												<Editor/>
											</AutoFormElement>
										</AutoForm>
									</Children>
									<Tools/>
								</Dialog>
								<UpdateAction id="msUpdateAction">
									<Property name="caption">保存方法标准Action</Property>
									<Property name="dataResolver">methodStandardService#saveMethodStandards</Property>
									<Property name="successMessage">保存成功！</Property>
									<UpdateItem>
										<Property name="dataSet">dsMethodStandards</Property>
									</UpdateItem>
								</UpdateAction>
							</Container>
						</ControlTab>
						<ControlTab>
							<Property name="caption">指标管理</Property>
							<Property name="name">指标管理</Property>
						</ControlTab>
					</TabControl>
				</Container>
			</MainControl>
			<SideControl>
				<Container>
					<ToolBar>
						<DataPilot>
							<Property name="dataSet">dsStandards</Property>
							<Property name="itemCodes">pages,+,-</Property>
							<ClientEvent name="onSubControlAction" signature="self,arg">var datas = view.get(&quot;#dsStandards.data&quot;);
var action = view.get(&quot;#standardUpdateAction&quot;);
switch(arg.code){
	case &quot;+&quot;:{
		datas.insert();
		view.get(&quot;#standardDialog&quot;).show();
		arg.processDefault=false;
		break;
	}
	case &quot;-&quot;:{
		dorado.MessageBox.confirm(&quot;您真的想删除当前数据吗?&quot;,function(){
			datas.remove();
			action.execute();
		});
		arg.processDefault=false;
		break;
	}
}</ClientEvent>
						</DataPilot>
						<Separator/>
						<ToolBarButton id="btEdit">
							<Property name="caption">编辑</Property>
							<Property name="iconClass">fa fa-pencil</Property>
							<ClientEvent name="onClick" signature="self,arg">var dsStandards = view.id(&quot;dsStandards&quot;);
var currData = dsStandards.getData(&quot;#&quot;);
if(currData){
 	view.id(&quot;standardDialog&quot;).show();
}</ClientEvent>
						</ToolBarButton>
					</ToolBar>
					<DataGrid>
						<Property name="dataSet">dsStandards</Property>
						<Property name="readOnly">true</Property>
						<Property name="selectionMode">singleRow</Property>
						<Property name="showFilterBar">true</Property>
						<Property name="sortMode">serverSide</Property>
						<RowSelectorColumn/>
						<RowNumColumn/>
						<DataColumn>
							<Property name="property">id</Property>
							<Property name="visible">false</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">标准名称</Property>
							<Property name="property">name</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">标准号</Property>
							<Property name="property">standardNo</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">是否删除</Property>
							<Property name="property">isDeleted</Property>
							<Property name="visible">false</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">状态</Property>
							<Property name="property">status</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">备注</Property>
							<Property name="property">remark</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">创建时间</Property>
							<Property name="property">crTime</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">创建人</Property>
							<Property name="property">crUser</Property>
							<Editor/>
						</DataColumn>
					</DataGrid>
					<Dialog id="standardDialog">
						<Property name="caption">产品标准维护</Property>
						<Property name="height">480</Property>
						<Property name="iconClass">fa fa-th-list</Property>
						<Property name="width">480</Property>
						<Buttons>
							<Button id="saveStandardBtn">
								<Property name="caption">保存</Property>
								<ClientEvent name="onClick" signature="self,arg">var standardUpdateAction=view.id(&quot;standardUpdateAction&quot;);
var standardDialog=view.id(&quot;standardDialog&quot;);
standardUpdateAction.execute(function(){
  standardDialog.hide();
});</ClientEvent>
							</Button>
							<Button id="closeStanardardBtn">
								<Property name="caption">取消</Property>
								<ClientEvent name="onClick" signature="self,arg">var standardDialog=view.id(&quot;standardDialog&quot;);
standardDialog.hide();</ClientEvent>
							</Button>
						</Buttons>
						<Children>
							<AutoForm>
								<Property name="cols">*</Property>
								<Property name="dataSet">dsStandards</Property>
								<AutoFormElement>
									<Property name="label">标准名称</Property>
									<Property name="property">name</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">标准号</Property>
									<Property name="property">standardNo</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">状态</Property>
									<Property name="property">status</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">备注</Property>
									<Property name="property">remark</Property>
									<Editor/>
								</AutoFormElement>
							</AutoForm>
						</Children>
						<Tools/>
					</Dialog>
					<UpdateAction id="standardUpdateAction">
						<Property name="dataResolver">standardService#saveStandards</Property>
						<Property name="executingMessage">正在保存...</Property>
						<Property name="successMessage">保存成功！</Property>
						<UpdateItem>
							<Property name="dataSet">dsStandards</Property>
						</UpdateItem>
					</UpdateAction>
				</Container>
			</SideControl>
		</SplitPanel>
	</View>
</ViewConfig>