<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
	<Arguments/>
	<Context/>
	<Model>
		<DataType name="dtStandards" parent="standardDataType">
		</DataType>
		<DataType name="dtMethodStandard" parent="methodStandardDataType">
		</DataType>
		<DataType name="dtStandardIndex" parent="standardIndexDataType">
		</DataType>
	</Model>
	<View>
		<Property name="packages">font-awesome</Property>
		<DataSet id="dsStandards">
			<Property name="dataProvider">standardService#queryStandards</Property>
			<Property name="dataType">[dtStandards]</Property>
			<Property name="pageSize">20</Property>
			<ClientEvent name="onReady" signature="self,arg">var  dsStandards=view.id(&quot;dsStandards&quot;);
var  sdata=dsStandards.getData(&quot;#&quot;);
var dsMethodStandards=view.id(&quot;dsMethodStandards&quot;);
var dsStandardIndexs=view.id(&quot;dsStandardIndexs&quot;);
if(sdata){
  dsMethodStandards.set(&quot;parameter&quot;,sdata.get(&quot;id&quot;)).flushAsync();
  dsStandardIndexs.set(&quot;parameter&quot;,sdata.get(&quot;id&quot;)).flushAsync();
}</ClientEvent>
		</DataSet>
		<DataSet id="dsMethodStandards">
			<Property name="dataProvider">methodStandardService#queryMethodStandards</Property>
			<Property name="dataType">[methodStandardDataType]</Property>
			<Property name="pageSize">20</Property>
		</DataSet>
		<DataSet id="dsStandardIndexs">
			<Property name="dataProvider">standardIndexService#queryStandardIndexs</Property>
			<Property name="dataType">[dtStandardIndex]</Property>
			<Property name="pageSize">20</Property>
		</DataSet>
		<SplitPanel>
			<Property name="direction">top</Property>
			<Property name="position">250</Property>
			<MainControl>
				<Container>
					<TabControl>
						<Property name="currentTab">0</Property>
						<ControlTab id="msCtrl">
							<Property name="caption">方法标准管理</Property>
							<Property name="iconClass">fa fa-th-large</Property>
							<Property name="name">msCtrlName</Property>
							<Container>
								<ToolBar>
									<DataPilot>
										<Property name="dataSet">dsMethodStandards</Property>
										<Property name="itemCodes">pages,+,-</Property>
										<ClientEvent name="onSubControlAction" signature="self,arg">var action = view.get(&quot;#msUpdateAction&quot;);
var dsStandards = view.id(&quot;dsStandards&quot;);
var sData = dsStandards.getData(&quot;#&quot;);
if(sData){
  var standardId=sData.get(&quot;id&quot;);
}

var datas=view.id(&quot;dsMethodStandards&quot;).get(&quot;data&quot;);

switch(arg.code){
	case &quot;+&quot;:{
		var entity=datas.insert();
    entity.set(&quot;standardId&quot;,standardId);
		view.get(&quot;#methodStandardDialog&quot;).show();
		arg.processDefault=false;
		break;
	}
	case &quot;-&quot;:{
		dorado.MessageBox.confirm(&quot;您真的想删除当前数据吗?&quot;,function(){
			datas.remove();
			action.execute();
		});
		arg.processDefault=false;
		break;
	}
}</ClientEvent>
									</DataPilot>
									<Separator/>
									<ToolBarButton id="editMsBtn">
										<Property name="caption">编辑</Property>
										<Property name="iconClass">fa fa-pencil</Property>
										<ClientEvent name="onClick" signature="self,arg">var dsMethodStandards =view.id(&quot;dsMethodStandards&quot;);
var currData=dsMethodStandards.getData(&quot;#&quot;);
if(currData){
  view.id(&quot;methodStandardDialog&quot;).show();
}</ClientEvent>
									</ToolBarButton>
								</ToolBar>
								<DataGrid id="methodStandardDataGrid">
									<Property name="dataSet">dsMethodStandards</Property>
									<Property name="readOnly">true</Property>
									<Property name="showFilterBar">true</Property>
									<Property name="sortMode">serverSide</Property>
									<DataColumn>
										<Property name="caption">标准名称</Property>
										<Property name="property">name</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">标准号</Property>
										<Property name="property">standardNo</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">状态</Property>
										<Property name="property">status</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">基准价格</Property>
										<Property name="property">price</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">单位</Property>
										<Property name="property">unit</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">备注</Property>
										<Property name="property">remark</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">创建人</Property>
										<Property name="property">crUser</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="caption">创建时间</Property>
										<Property name="property">crTime</Property>
										<Editor/>
									</DataColumn>
								</DataGrid>
								<Dialog id="methodStandardDialog">
									<Property name="caption">方法标准维护</Property>
									<Property name="height">350</Property>
									<Property name="iconClass">fa fa-th-list</Property>
									<Property name="width">480</Property>
									<Buttons>
										<Button id="saveMsBtn">
											<Property name="caption">保存</Property>
											<Property name="iconClass">fa fa-save</Property>
											<ClientEvent name="onClick" signature="self,arg">var msUpdateAction=view.id(&quot;msUpdateAction&quot;);
var methodStandardDialog=view.id(&quot;methodStandardDialog&quot;);
var dsStandards=view.id(&quot;dsStandards&quot;);
var standardId=dsStandards.getData(&quot;#&quot;).get(&quot;id&quot;);
var dsMethodStandards=view.id(&quot;dsMethodStandards&quot;);
msUpdateAction.execute(function(){
  methodStandardDialog.hide();
  dsMethodStandards.set(&quot;parameter&quot;,standardId).flushAsync();
});</ClientEvent>
										</Button>
										<Button id="cancelMsBtn">
											<Property name="caption">取消</Property>
											<Property name="iconClass">fa fa-undo</Property>
											<ClientEvent name="onClick" signature="self,arg">var methodStandardDialog=view.id(&quot;methodStandardDialog&quot;);
var dsMethodStandards=view.id(&quot;dsMethodStandards&quot;);
var data=dsMethodStandards.get(&quot;data&quot;);
data.cancel();
methodStandardDialog.hide();</ClientEvent>
										</Button>
									</Buttons>
									<Children>
										<AutoForm id="msAutoForm">
											<Property name="cols">＊</Property>
											<Property name="dataSet">dsMethodStandards</Property>
											<Property name="stretchWidth">true</Property>
											<AutoFormElement id="name">
												<Property name="label">标准名称</Property>
												<Property name="property">name</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">标准号</Property>
												<Property name="property">standardNo</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">基准价格</Property>
												<Property name="property">price</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">单位</Property>
												<Property name="property">unit</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="editable">false</Property>
												<Property name="label">状态</Property>
												<Property name="property">status</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="label">备注</Property>
												<Property name="property">remark</Property>
												<Editor>
													<TextArea/>
												</Editor>
											</AutoFormElement>
										</AutoForm>
									</Children>
									<Tools/>
								</Dialog>
								<UpdateAction id="msUpdateAction">
									<Property name="caption">保存方法标准Action</Property>
									<Property name="dataResolver">methodStandardService#saveMethodStandards</Property>
									<Property name="successMessage">保存成功！</Property>
									<UpdateItem>
										<Property name="dataSet">dsMethodStandards</Property>
									</UpdateItem>
								</UpdateAction>
							</Container>
						</ControlTab>
						<ControlTab id="siCtrl">
							<Property name="caption">项目指标管理</Property>
							<Property name="iconClass">fa fa-th-large</Property>
							<Property name="name">siCtrlName</Property>
							<Container>
								<ToolBar>
									<DataPilot id="siDataPilot">
										<Property name="dataSet">dsStandardIndexs</Property>
										<Property name="itemCodes">pages,+,-</Property>
										<ClientEvent name="onSubControlAction" signature="self,arg">var action = view.get(&quot;#siUpdateAction&quot;);
var dsStandards = view.id(&quot;dsStandards&quot;);
var sData = dsStandards.getData(&quot;#&quot;);
if(sData){
  var standardId=sData.get(&quot;id&quot;);
}

var datas=view.id(&quot;dsStandardIndexs&quot;).get(&quot;data&quot;);

switch(arg.code){
	case &quot;+&quot;:{
		var entity=datas.insert();
    entity.set(&quot;standardId&quot;,standardId);
		view.get(&quot;#standardIndexDialog&quot;).show();
		arg.processDefault=false;
		break;
	}
	case &quot;-&quot;:{
		dorado.MessageBox.confirm(&quot;您真的想删除当前数据吗?&quot;,function(){
			datas.remove();
			action.execute();
		});
		arg.processDefault=false;
		break;
	}
}</ClientEvent>
									</DataPilot>
									<Separator/>
									<ToolBarButton id="editStandardIndexBtn">
										<Property name="caption">编辑</Property>
										<Property name="iconClass">fa fa-pencil</Property>
										<ClientEvent name="onClick" signature="self,arg">var dsStandardIndexs =view.id(&quot;dsStandardIndexs&quot;);
var currData=dsStandardIndexs.getData(&quot;#&quot;);
if(currData){
  view.id(&quot;standardIndexDialog&quot;).show();
}</ClientEvent>
									</ToolBarButton>
								</ToolBar>
								<DataGrid id="standardIndexDataGrid">
									<Property name="dataSet">dsStandardIndexs</Property>
									<Property name="readOnly">true</Property>
									<Property name="showFilterBar">true</Property>
									<Property name="sortMode">serverSide</Property>
									<DataColumn>
										<Property name="property">name</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="property">value</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="property">unit</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="property">remark</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="property">crUser</Property>
										<Editor/>
									</DataColumn>
									<DataColumn>
										<Property name="property">crTime</Property>
										<Editor/>
									</DataColumn>
								</DataGrid>
								<Dialog id="standardIndexDialog">
									<Property name="caption">项目指标管理</Property>
									<Property name="height">300</Property>
									<Property name="iconClass">fa fa-th-list</Property>
									<Property name="width">380</Property>
									<Buttons>
										<Button id="saveSiBtn">
											<Property name="caption">保存</Property>
											<Property name="iconClass">fa fa-save</Property>
											<ClientEvent name="onClick" signature="self,arg">var siUpdateAction=view.id(&quot;siUpdateAction&quot;);
var standardIndexDialog=view.id(&quot;standardIndexDialog&quot;);
var dsStandards=view.id(&quot;dsStandards&quot;);
var standardId=dsStandards.getData(&quot;#&quot;).get(&quot;id&quot;);
var dsStandardIndexs=view.id(&quot;dsStandardIndexs&quot;);
siUpdateAction.execute(function(){
  standardIndexDialog.hide();
  dsStandardIndexs.set(&quot;parameter&quot;,standardId).flushAsync();
});</ClientEvent>
										</Button>
										<Button id="cancelSiBtn">
											<Property name="caption">取消</Property>
											<Property name="iconClass">fa fa-undo</Property>
											<ClientEvent name="onClick" signature="self,arg">var standardIndexDialog=view.id(&quot;standardIndexDialog&quot;);
var dsStandardIndexs=view.id(&quot;dsStandardIndexs&quot;);
var data=dsStandardIndexs.get(&quot;data&quot;);
data.cancel();
standardIndexDialog.hide();</ClientEvent>
										</Button>
									</Buttons>
									<Children>
										<AutoForm id="siAutoForm">
											<Property name="cols">*</Property>
											<Property name="dataSet">dsStandardIndexs</Property>
											<Property name="stretchWidth">true</Property>
											<AutoFormElement>
												<Property name="property">name</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="property">value</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="property">unit</Property>
												<Editor/>
											</AutoFormElement>
											<AutoFormElement>
												<Property name="property">remark</Property>
												<Editor>
													<TextArea/>
												</Editor>
											</AutoFormElement>
										</AutoForm>
									</Children>
									<Tools/>
								</Dialog>
								<UpdateAction id="siUpdateAction">
									<Property name="dataResolver">standardIndexService#saveMethodStandards</Property>
									<Property name="executingMessage">正在保存...</Property>
									<Property name="successMessage">保存成功</Property>
									<UpdateItem>
										<Property name="dataSet">dsStandardIndexs</Property>
									</UpdateItem>
								</UpdateAction>
							</Container>
						</ControlTab>
					</TabControl>
				</Container>
			</MainControl>
			<SideControl>
				<Container>
					<ToolBar>
						<DataPilot>
							<Property name="dataSet">dsStandards</Property>
							<Property name="itemCodes">pages,+,-</Property>
							<ClientEvent name="onSubControlAction" signature="self,arg">var datas = view.get(&quot;#dsStandards.data&quot;);
var action = view.get(&quot;#standardUpdateAction&quot;);
switch(arg.code){
	case &quot;+&quot;:{
		datas.insert();
		view.get(&quot;#standardDialog&quot;).show();
		arg.processDefault=false;
		break;
	}
	case &quot;-&quot;:{
		dorado.MessageBox.confirm(&quot;您真的想删除当前数据吗?&quot;,function(){
			datas.remove();
			action.execute();
		});
		arg.processDefault=false;
		break;
	}
}</ClientEvent>
						</DataPilot>
						<Separator/>
						<ToolBarButton id="btEdit">
							<Property name="caption">编辑</Property>
							<Property name="iconClass">fa fa-pencil</Property>
							<ClientEvent name="onClick" signature="self,arg">var dsStandards = view.id(&quot;dsStandards&quot;);
var currData = dsStandards.getData(&quot;#&quot;);
if(currData){
 	view.id(&quot;standardDialog&quot;).show();
}</ClientEvent>
						</ToolBarButton>
					</ToolBar>
					<DataGrid id="standardDaraGrid">
						<Property name="dataSet">dsStandards</Property>
						<Property name="readOnly">true</Property>
						<Property name="selectionMode">singleRow</Property>
						<Property name="showFilterBar">true</Property>
						<Property name="sortMode">serverSide</Property>
						<ClientEvent name="onDataRowClick" signature="self,arg">var  dsStandards=view.id(&quot;dsStandards&quot;);
var  sdata=dsStandards.getData(&quot;#&quot;);
var dsMethodStandards=view.id(&quot;dsMethodStandards&quot;);
var dsStandardIndexs=view.id(&quot;dsStandardIndexs&quot;);
if(sdata){
  dsMethodStandards.set(&quot;parameter&quot;,sdata.get(&quot;id&quot;)).flushAsync();
  dsStandardIndexs.set(&quot;parameter&quot;,sdata.get(&quot;id&quot;)).flushAsync();
}
</ClientEvent>
						<DataColumn>
							<Property name="property">id</Property>
							<Property name="visible">false</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">标准名称</Property>
							<Property name="property">name</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">标准号</Property>
							<Property name="property">standardNo</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">是否删除</Property>
							<Property name="property">isDeleted</Property>
							<Property name="visible">false</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">状态</Property>
							<Property name="property">status</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">备注</Property>
							<Property name="property">remark</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">创建时间</Property>
							<Property name="property">crTime</Property>
							<Editor/>
						</DataColumn>
						<DataColumn>
							<Property name="caption">创建人</Property>
							<Property name="property">crUser</Property>
							<Editor/>
						</DataColumn>
					</DataGrid>
					<Dialog id="standardDialog">
						<Property name="caption">产品标准维护</Property>
						<Property name="height">300</Property>
						<Property name="iconClass">fa fa-th-list</Property>
						<Property name="width">480</Property>
						<Buttons>
							<Button id="saveStandardBtn">
								<Property name="caption">保存</Property>
								<Property name="iconClass">fa fa-floppy-o</Property>
								<ClientEvent name="onClick" signature="self,arg">var standardUpdateAction=view.id(&quot;standardUpdateAction&quot;);
var standardDialog=view.id(&quot;standardDialog&quot;);
var dsStandards=view.id(&quot;dsStandards&quot;);
standardUpdateAction.execute(function(){
  standardDialog.hide();
  dsStandards.flushAsync();
});</ClientEvent>
							</Button>
							<Button id="closeStanardardBtn">
								<Property name="caption">取消</Property>
								<Property name="iconClass">fa fa-undo</Property>
								<ClientEvent name="onClick" signature="self,arg">var standardDialog=view.id(&quot;standardDialog&quot;);
var datas = view.get(&quot;#dsStandards.data&quot;);
datas.cancel();
standardDialog.hide();</ClientEvent>
							</Button>
						</Buttons>
						<Children>
							<AutoForm>
								<Property name="cols">*</Property>
								<Property name="dataSet">dsStandards</Property>
								<AutoFormElement>
									<Property name="label">标准名称</Property>
									<Property name="property">name</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">标准号</Property>
									<Property name="property">standardNo</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">状态</Property>
									<Property name="property">status</Property>
									<Editor/>
								</AutoFormElement>
								<AutoFormElement>
									<Property name="label">备注</Property>
									<Property name="property">remark</Property>
									<Editor>
										<TextArea/>
									</Editor>
								</AutoFormElement>
							</AutoForm>
						</Children>
						<Tools/>
					</Dialog>
					<UpdateAction id="standardUpdateAction">
						<Property name="dataResolver">standardService#saveStandards</Property>
						<Property name="executingMessage">正在保存...</Property>
						<Property name="successMessage">保存成功！</Property>
						<UpdateItem>
							<Property name="dataSet">dsStandards</Property>
						</UpdateItem>
					</UpdateAction>
				</Container>
			</SideControl>
		</SplitPanel>
	</View>
</ViewConfig>